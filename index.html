<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doces da Tia üßÅ</title>
    <style>
        :root { --doce-rosa: #ff85a1; --doce-azul: #a2d2ff; --doce-verde: #25d366; }
        body { font-family: 'Segoe UI', sans-serif; background-color: #fff5f8; margin: 0; padding: 20px; text-align: center; }
        .vitrine { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; max-width: 800px; margin: auto; }
        .produto { background: white; padding: 15px; border-radius: 15px; border: 2px solid var(--doce-rosa); position: relative; }
        .img-produto { width: 100%; height: 110px; object-fit: contain; border-radius: 10px; margin-bottom: 8px; }
        .btn-add { background: var(--doce-rosa); color: white; border: none; padding: 10px; border-radius: 50%; cursor: pointer; font-size: 1.2em; width: 40px; height: 40px; }
        .btn-add:disabled { background: #ccc; cursor: not-allowed; }
        .carrinho-btn { position: fixed; bottom: 20px; right: 20px; background: var(--doce-verde); color: white; border: none; padding: 15px 25px; border-radius: 30px; font-weight: bold; cursor: pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
    </style>
</head>
<body>
    <h1 style="color: #d63384;">üßÅ Card√°pio da Tia</h1>
    <div class="vitrine" id="lista-produtos">Carregando doces...</div>
    <button class="carrinho-btn" onclick="window.location.href='login.html'">‚öôÔ∏è √Årea do Admin</button>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, collection, query, where, onSnapshot } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyB6FUb-KoF6S4h-y70trrcElPb2AYuUogM",
            authDomain: "tia-do-doce.firebaseapp.com",
            projectId: "tia-do-doce",
            storageBucket: "tia-do-doce.firebasestorage.app",
            messagingSenderId: "766286783719",
            appId: "1:766286783719:web:f49c11f7190c88cc44ae42"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // ESCUTA EM TEMPO REAL: Filtra produtos onde ativo == true
        onSnapshot(query(collection(db, "produtos"), where("ativo", "==", true)), (snap) => {
            const cont = document.getElementById('lista-produtos');
            cont.innerHTML = "";
            snap.forEach(d => {
                const p = d.data();
                const foto = p.fotoUrl || 'balassortidas.webp';
                cont.innerHTML += `
                    <div class="produto">
                        <img src="${foto}" class="img-produto" onerror="this.src='balassortidas.webp'">
                        <strong style="font-size:0.9em;">${p.nome}</strong><br>
                        <span style="color:var(--doce-rosa); font-weight:bold;">R$ ${p.preco.toFixed(2)}</span><br><br>
                        <button class="btn-add" ${p.estoque <= 0 ? 'disabled' : ''}>
                            ${p.estoque <= 0 ? 'Fim' : '+'}
                        </button>
                    </div>`;
            });
        });
    </script>
</body>
</html>

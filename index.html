<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doces da Tia</title>
    <style>
        body { font-family: sans-serif; text-align: center; background: #fff; margin: 0; padding: 20px; }
        .vitrine { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; }
        .produto { border: 1px solid #ccc; padding: 10px; border-radius: 10px; width: 150px; }
        .img-produto { width: 100px; height: 100px; object-fit: contain; }
        .btn-add { background: #ff85a1; color: #fff; border: none; padding: 10px; border-radius: 5px; cursor: pointer; }
        .btn-add:disabled { background: #eee; color: #999; }
    </style>
</head>
<body>
    <h1>Doces da Tia</h1>
    <div class="vitrine" id="lista-produtos">Carregando...</div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, collection, query, where, onSnapshot } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyB6FUb-KoF6S4h-y70trrcElPb2AYuUogM",
            authDomain: "tia-do-doce.firebaseapp.com",
            projectId: "tia-do-doce",
            storageBucket: "tia-do-doce.firebasestorage.app",
            messagingSenderId: "766286783719",
            appId: "1:766286783719:web:f49c11f7190c88cc44ae42"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Filtra apenas produtos ativos
        onSnapshot(query(collection(db, "produtos"), where("ativo", "==", true)), (snap) => {
            const cont = document.getElementById('lista-produtos');
            cont.innerHTML = "";
            snap.forEach(d => {
                const p = d.data();
                cont.innerHTML += `
                    <div class="produto">
                        <img src="${p.fotoUrl}" class="img-produto" onerror="this.src='balassortidas.webp'">
                        <p><strong>${p.nome}</strong></p>
                        <p>R$ ${p.preco.toFixed(2)}</p>
                        <button class="btn-add" ${p.estoque <= 0 ? 'disabled' : ''}>
                            ${p.estoque <= 0 ? 'Faltando' : 'Adicionar'}
                        </button>
                    </div>`;
            });
        });
    </script>
</body>
</html>
